{% extends "base.html" %}

{% block content %}
<img src="{{ game.cover.url }}" class="img-responsive" />
<h1>{{ game.name }}</h1>
<p>{{ game.description }}</p>

{% if request.user.is_authenticated %}
<center><a href="#event" data-toggle="modal"><h3>Create new event</h3></a></center>
{% endif %}

{% for event in events %}
<div class="row">
  <div class="col-sm-12">
    <div class="thumbnail">
      <div class="caption">
	<h3><a href="/event/{{ event.id }}">{{ event.name }}</a></h3>
	<p>
	  {{ event.participation_set.count }}/{{ event.participant_number }} participants
	  <a href="/social/application/{{ event.id }}" class="btn btn-primary btn-sm" role="button">Apply</a>
	</p>
	<p>{{ event.description }}</p>
      </div>
    </div>
  </div>
</div>
{% endfor %}

<div class="pagination">
    <span class="step-links">
        {% if events.has_previous %}
            <a href="?page={{ events.previous_page_number }}">previous</a>
        {% endif %}

        <span class="current">
            Page {{ events.number }} of {{ events.paginator.num_pages }}.
        </span>

        {% if events.has_next %}
            <a href="?page={{ events.next_page_number }}">next</a>
        {% endif %}
    </span>
</div>
{% endblock content %}

{% if request.user.is_authenticated %}
{% block modals %}

<div class="modal fade" id="event" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
	<form method='POST'>{% csrf_token %}
	  {{ form.media }}
	  {{ form.as_p }}
	  <input type='submit' value='Create event' />
	</form>
      </div>
    </div>
  </div>
</div>

{% endblock modals %}
{% endif %}
